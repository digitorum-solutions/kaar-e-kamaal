<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base target="_top">
    <style>
      body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
        background-image: url('bg.jpeg');
        background-size: cover;
        background-position: top center;
        background-repeat: no-repeat;
        position: relative;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: -1;
      }

      .logo-left,
      .logo-right {
        position: fixed;
        top: 20px;
        width: 140px;
        height: auto;
        z-index: 2;
      }

      .logo-left {
        left: 20px;
      }

      .logo-right {
        right: 20px;
      }

      .center-header {
        text-align: center;
        margin-top: 40px;
        z-index: 2;
        position: relative;
      }

      .center-header img {
        width: 160px;
        height: auto;
        margin-bottom: 10px;
      }

      .status-button {
        display: inline-block;
        background-color: #673ab7;
        color: white;
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: bold;
        text-decoration: none;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      }

      .status-button:hover {
        background-color: #5e35b1;
      }

      .container {
        max-width: 600px;
        margin: 30px auto;
        background: rgba(255, 255, 255, 0.95);
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        border-top: 10px solid #673ab7;
        position: relative;
        z-index: 1;
      }

      h2 {
        text-align: center;
        color: #673ab7;
        margin-bottom: 20px;
      }

      label {
        font-weight: bold;
        margin-top: 15px;
        display: block;
      }

      input[type="text"],
      input[type="tel"],
      textarea {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 14px;
      }

      input::placeholder,
      textarea::placeholder {
        color: rgba(0, 0, 0, 0.5);
        font-style: italic;
      }

      textarea[name="caseDetail"] {
        min-height: 120px;
      }

      .radio-row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 10px;
      }

      .radio-row label {
        font-weight: normal;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      input[type="radio"] {
        accent-color: #673ab7;
      }

      button {
        background: #673ab7;
        color: white;
        padding: 12px;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        width: 100%;
        margin-top: 30px;
        cursor: pointer;
      }

      button:hover {
        background: #5e35b1;
      }

      /* Spinner Modal */
      #spinnerModal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(6px);
      }

      .spinner-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 30px 20px;
        border-radius: 16px;
        text-align: center;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        max-width: 320px;
      }

      .spinner-content h3 {
        font-size: 18px;
        color: #673ab7;
        margin-bottom: 15px;
        font-weight: bold;
      }

      .spinner-content p {
        font-size: 22px;
        color: #222;
        font-family: 'Scheherazade', serif;
        margin-bottom: 25px;
      }

      .spinner-loader {
        width: 50px;
        height: 50px;
        border: 4px solid #673ab7;
        border-top: 4px solid transparent;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        margin: auto;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @media (max-width: 920px) {
        .container {
          width: 330px;
          padding: 30px 15px;
        }

        .logo-left,
        .logo-right {
          position: absolute;
        }

        body {
          background-image: url('bg-mobile.jpeg');
          background-size: cover;
          background-position: top center;
        }
      }
    </style>
  </head>

  <body>
    <!-- Spinner Modal -->
    <div id="spinnerModal">
      <div class="spinner-content">
        <h3>Recite Darood Shareef At least 3 Times</h3>
        <p>اللّهُمَّ صَلِّ عَلَى مُحَمَّدٍ وَعَلَى آلِ مُحَمَّدٍ</p>
        <div class="spinner-loader"></div>
      </div>
    </div>

    <div>
      <img src="https://i.postimg.cc/rFH70bnH/logoa.png" class="logo-left" alt="Left Logo">
      <img src="https://i.postimg.cc/pTvChxHj/Screenshot-2025-08-28-001100-removebg-preview.png" class="logo-right" alt="Right Logo">
      <div class="center-header">
        <img src="https://i.postimg.cc/G2Dxzfq2/logo.png" alt="Center Logo">
        <br>
        <a href="https://referred-case-status.vercel.app/" target="_blank" class="status-button">
          Referred Case Status
        </a>
      </div>

      <div class="container">
        <h2>Case Referral Form</h2>
        <form id="caseForm">
          <label>Date</label>
          <input type="text" id="caseDate" readonly>

          <label>Referrer Name</label>
          <input type="text" name="referrerName" placeholder="Enter contact name of the person who referred the case" required>

          <label>Referrer Contact</label>
          <input type="tel" name="referrerContact" placeholder="+92XXXXXXXXXX Who Referred The Case" pattern="^\+92[0-9]{10}$" required>

          <label>Case Region/City</label>
          <input type="text" name="caseRegion" placeholder="Enter region or city" required>

          <label>Family Member Name</label>
          <input type="text" name="familyMemberName" placeholder="Enter family member name" required>

          <label>Family Member Contact</label>
          <input type="tel" name="familyMemberContact" placeholder="+92XXXXXXXXXX Family Number" pattern="^\+92[0-9]{10}$" required>

          <label>Address</label>
          <textarea name="address" placeholder="Enter proper address" required></textarea>

          <label>Who Are You? *</label>
          <div class="radio-row">
            <label><input type="radio" name="personType" value="Kamalian" required> Kamalian</label>
            <label><input type="radio" name="personType" value="Non-Kamalian"> Non-Kamalian</label>
          </div>

          <label>House Type *</label>
          <div class="radio-row">
            <label><input type="radio" name="houseType" value="Rent" required> Rent</label>
            <label><input type="radio" name="houseType" value="Own"> Own</label>
          </div>

          <label>Case For? *</label>
          <div class="radio-row">
            <label><input type="radio" name="caseType" value="Rashion" required> Rashion</label>
            <label><input type="radio" name="caseType" value="Fee"> Fee</label>
            <label><input type="radio" name="caseType" value="Medical"> Medical</label>
            <label><input type="radio" name="caseType" value="Rozghaar"> Rozghaar</label>
          </div>

          <label>Case Detail</label>
          <textarea name="caseDetail" placeholder="Provide proper case details" required></textarea>

          <button type="submit">Submit</button>
        </form>
      </div>
    </div>

    <script>
      const dateInput = document.getElementById("caseDate");
      const today = new Date();
      dateInput.value = today.toLocaleDateString("en-GB");

      const form = document.getElementById("caseForm");
      const submitButton = form.querySelector('button[type="submit"]');
      const spinnerModal = document.getElementById("spinnerModal");

      function validateNumber(input) {
        const pattern = /^\+92[0-9]{10}$/;
        input.setCustomValidity(pattern.test(input.value) ? "" : "Enter number in +92XXXXXXXXXX format");
      }

      document.querySelectorAll('input[type="tel"]').forEach(input => {
        input.addEventListener("input", () => validateNumber(input));
      });

      form.addEventListener("submit", e => {
        e.preventDefault();

        submitButton.disabled = true;
        spinnerModal.style.display = "block";

        const data = new FormData(form);
        fetch("https://script.google.com/macros/s/AKfycbxirFr1DYb0gPWieTyXz8DfHbN9eG7RWEFX-0_eTgT-CKrvrbRiGGCjbNBEXJ47t0oB7Q/exec", {
          method: "POST",
          body: data
        })
          .then(res => res.ok ? res.text() : Promise.reject("Network error"))
          .then(() => {
            alert("✅ Form submitted successfully!");
            form.reset();
            dateInput.value = today.toLocaleDateString("en-GB");
          })
          .catch(() => {
            alert("❌ Error submitting form. Please try again.");
          })
          .finally(() => {
            submitButton.disabled = false;
            spinnerModal.style.display = "none";
          });
      });
    </script>
  </body>
</html>
